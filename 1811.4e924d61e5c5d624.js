"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1811],{81811:function(e,t,r){r.r(t),r.d(t,{RepayModal:function(){return Ae}});var n=r(59499),a=r(49501),o=r(67294),s=r(47130),i=r(46839),l=r(8195),u=r(46930),c=r(63206),d=r(31959),p=r(94635),m=r(1279),y=r(52358),b=r(30120),f=r(81645),v=r(29630),x=r(9144),h=r(70794),g=r(25935),A=r(41024),S=r(72667),j=r(74119),w=r(50029),T=r(87794),O=r.n(T),C=r(25808),k=r(77537),E=r(12036),P=r(68448),R=r(53601),D=r(93608),L=r(57824),B=r(94671),N=r(99730),I=r(17674),U=r(4730),W=r(75331),Z=r(80854),_=r(21732),F=r(78371),M=r(67489),Y=r(85893),H=["repayAmount","poolReserve","fromAssetData","isWrongNetwork","sx","symbol","rateMode","repayAllDebt","useFlashLoan","blocked","loading","repayWithAmount","buildTxFn"];function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q=function(e){var t,r=e.repayAmount,n=e.poolReserve,o=e.fromAssetData,s=e.isWrongNetwork,i=e.sx,l=e.symbol,u=e.rateMode,c=e.repayAllDebt,d=e.useFlashLoan,p=e.blocked,m=e.loading,y=e.repayWithAmount,b=e.buildTxFn,f=(0,U.Z)(e,H),v=(0,F.Y)((function(e){return[e.paraswapRepayWithCollateral,e.currentMarketData]})),x=(0,I.Z)(v,2),h=x[0],g=x[1],A=(0,_.P)({protocolAction:W.UQ.repayCollateral,handleGetTxns:function(){var e=(0,w.Z)(O().mark((function e(t,a){var i;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:return i=e.sent,e.abrupt("return",h({repayAllDebt:c,repayAmount:r,rateMode:u,repayWithAmount:y,fromAssetData:o,poolReserve:n,isWrongNetwork:s,symbol:l,useFlashLoan:d,blocked:p,swapCallData:i.swapCallData,augustus:i.augustus,signature:t,deadline:a,signedAmount:(0,j.sm)(y,o.decimals)}));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),handleGetApprovalTxns:function(){var e=(0,w.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h({repayAllDebt:c,repayAmount:r,rateMode:u,repayWithAmount:y,fromAssetData:o,poolReserve:n,isWrongNetwork:s,symbol:l,useFlashLoan:!1,blocked:p,swapCallData:"0x",augustus:Z.hP}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),gasLimitRecommendation:Z.eB[W.UQ.repayCollateral].limit,skip:m||!r||0===parseFloat(r)||p,spender:null!==(t=g.addresses.REPAY_WITH_COLLATERAL_ADAPTER)&&void 0!==t?t:"",deps:[o.symbol,y]}),S=A.approval,T=A.action,C=A.loadingTxns,k=A.approvalTxState,E=A.mainTxState,P=A.requiresApproval;return(0,Y.jsx)(M.B,q(q({preparingTransactions:C,mainTxState:E,approvalTxState:k,requiresAmount:!0,amount:r,requiresApproval:P,isWrongNetwork:s,blocked:p,sx:i},f),{},{handleAction:T,handleApproval:function(){return S({amount:(0,j.sm)(y,o.decimals),underlyingAsset:o.aTokenAddress})},actionText:(0,Y.jsx)(a.cC,{id:"Repay {symbol}",values:{symbol:l}}),actionInProgressText:(0,Y.jsx)(a.cC,{id:"Repaying {symbol}",values:{symbol:l}}),fetchingData:m,errorParams:{loading:!1,disabled:p,content:(0,Y.jsx)(a.cC,{id:"Repay {symbol}",values:{symbol:l}}),handleClick:T},tryPermit:!0}))};function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e){var t=e.poolReserve,r=e.symbol,n=e.debtType,s=e.userReserve,c=e.isWrongNetwork,d=e.user,p=(0,i.HT)(),T=p.reserves,I=p.userReserves,U=(0,l.vR)(),W=U.gasLimit,Z=U.txError,_=U.mainTxState,F=(0,u.f)(),M=F.currentChainId,H=F.currentNetworkConfig,V=(0,k.Z)().currentAccount,q=d.userReservesData.filter((function(e){return"0"!==e.underlyingBalance&&e.underlyingAsset!==t.underlyingAsset&&"stETH"!==e.reserve.symbol})).map((function(e){return{address:e.underlyingAsset,balance:e.underlyingBalance,balanceUSD:e.underlyingBalanceUSD,symbol:e.reserve.symbol,iconSymbol:e.reserve.iconSymbol,decimals:e.reserve.decimals}})).sort((function(e,t){return Number(t.balanceUSD)-Number(e.balanceUSD)})),G=(0,o.useState)(q[0]),K=G[0],X=G[1],J=K.balance||"0",$="exactOut",ee=(0,o.useState)(""),te=ee[0],re=ee[1],ne=(0,o.useState)("0.5"),ae=ne[0],oe=ne[1],se=(0,o.useRef)(""),ie=T.find((function(e){return e.underlyingAsset===K.address})),le=(null===s||void 0===s?void 0:s.variableBorrows)||"0",ue=(0,m.hE)(le);ue=ue.plus(ue.multipliedBy(t.variableBorrowAPY).dividedBy(17280));var ce="-1"===te,de=ce?ue.toString():te,pe=(0,m.hE)(de).multipliedBy(t.priceInUSD).toString(),me=ue.multipliedBy(t.priceInUSD).multipliedBy(100+Number(ae)).dividedBy(100).dividedBy(ie.priceInUSD),ye=z(z({},ie),{},{amount:J}),be=z(z({},t),{},{amount:se.current}),fe=ce&&(0,m.hE)(J).gte(me),ve=function(e){var t=e.chainId,r=e.max,n=e.maxSlippage,a=e.skip,s=e.swapIn,i=e.swapOut,l=e.userAddress,u=e.swapVariant,c=(0,o.useState)("0"),d=c[0],p=c[1],y=(0,o.useState)("0"),b=y[0],f=y[1],v=(0,o.useState)("0"),x=v[0],h=v[1],g=(0,o.useState)("0"),A=g[0],S=g[1],T=(0,o.useState)(),C=T[0],k=T[1],E=(0,o.useState)(!1),P=E[0],R=E[1],D=(0,o.useState)(""),L=D[0],B=D[1],N=(0,o.useMemo)((function(){return{underlyingAsset:s.underlyingAsset,decimals:s.decimals,supplyAPY:s.supplyAPY,amount:s.amount,variableBorrowAPY:s.variableBorrowAPY}}),[s.amount,s.decimals,s.supplyAPY,s.underlyingAsset,s.variableBorrowAPY]),I=(0,o.useMemo)((function(){return{underlyingAsset:i.underlyingAsset,decimals:i.decimals,supplyAPY:i.supplyAPY,amount:i.amount,variableBorrowAPY:i.variableBorrowAPY}}),[i.amount,i.decimals,i.supplyAPY,i.underlyingAsset,i.variableBorrowAPY]),U=(0,o.useCallback)((function(){return(0,j.F8)(N,I,t,l)}),[t,N,I,l]),W=(0,o.useCallback)((function(){return(0,j.wP)(N,I,t,l,r)}),[t,r,N,I,l]);return(0,o.useEffect)((function(){if(!a){var e=function(){var e=(0,w.Z)(O().mark((function e(){var t,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N.underlyingAsset&&I.underlyingAsset&&("exactIn"!==u||N.amount&&"0"!==N.amount&&!isNaN(+N.amount))&&("exactOut"!==u||I.amount&&"0"!==I.amount&&!isNaN(+I.amount))){e.next=7;break}return p("0"),f("0"),h("0"),S("0"),k(void 0),e.abrupt("return");case 7:if(R(!0),e.prev=8,"exactIn"!==u){e.next=15;break}return e.next=12,U();case 12:t=e.sent,e.next=18;break;case 15:return e.next=17,W();case 17:t=e.sent;case 18:B(""),k(t),p((0,m.Fv)(t.srcAmount,t.srcDecimals)),h((0,m.Fv)(t.destAmount,t.destDecimals)),f(t.srcUSD),S(t.destUSD),e.next=31;break;case 26:e.prev=26,e.t0=e.catch(8),console.error(e.t0),r=(0,j.aE)(e.t0.message),B(r);case 31:return e.prev=31,R(!1),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[8,26,31,34]])})));return function(){return e.apply(this,arguments)}}(),t=setTimeout((function(){e()}),400);return function(){clearTimeout(t)}}}),[a,u,N.underlyingAsset,N.amount,I.underlyingAsset,I.amount,U,W,n]),{outputAmount:x,outputAmountUSD:A,inputAmount:d,inputAmountUSD:b,loading:P,error:L,buildTxFn:function(){var e=(0,w.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C){e.next=2;break}throw new Error("Route required to build transaction");case 2:if("exactIn"!==u){e.next=6;break}return e.abrupt("return",(0,j.xS)(C,s,i,t,l,n));case 6:return e.abrupt("return",(0,j._n)(C,s,i,t,l,n));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}({chainId:H.underlyingChainId||M,userAddress:V,swapVariant:$,swapIn:ye,swapOut:be,max:fe,skip:_.loading||!1,maxSlippage:Number(ae)}),xe=ve.inputAmountUSD,he=ve.inputAmount,ge=ve.outputAmount,Ae=ve.outputAmountUSD,Se=ve.loading,je=ve.error,we=ve.buildTxFn,Te=Se&&"0"===xe,Oe=function(e){var t="-1"===e;se.current=t?ue.toString(10):e,re(e)},Ce=I.find((function(e){return e.underlyingAsset===K.address})),ke=(0,P.bU)({amountToReceiveAfterSwap:ge,amountToSwap:he,fromAssetData:ie,user:d,toAssetData:t,repayWithUserReserve:Ce,debt:le}),Ee=ke.hfAfterSwap,Pe=ke.hfEffectOfFromAmount,Re=(0,B.gK)(d.healthFactor,Pe.toString())||(null===ie||void 0===ie?void 0:ie.isFrozen),De=(0,m.hE)(le).minus(h.Z.min(ge,le)),Le=De.multipliedBy(t.priceInUSD),Be=J?(0,m.hE)(J).minus(he):(0,m.hE)("0"),Ne=Be.multipliedBy(ie.priceInUSD),Ie=de,Ue=pe,We=(0,C.W)(),Ze=void 0;We.length>0&&!We.includes(K.symbol)?Ze=B.NI.ZERO_LTV_WITHDRAW_BLOCKED:(0,m.hE)(J).lt(he)?Ze=B.NI.NOT_ENOUGH_COLLATERAL_TO_REPAY_WITH:Re&&!ie.flashLoanEnabled&&(Ze=B.NI.FLASH_LOAN_NOT_AVAILABLE);var _e=function(){switch(Ze){case B.NI.NOT_ENOUGH_COLLATERAL_TO_REPAY_WITH:return(0,Y.jsx)(a.cC,{id:"Not enough collateral to repay this amount of debt with"});case B.NI.ZERO_LTV_WITHDRAW_BLOCKED:return(0,Y.jsx)(a.cC,{id:"Assets with zero LTV ({0}) must be withdrawn or disabled as collateral to perform this action",values:{0:We.join(", ")}});case B.NI.FLASH_LOAN_NOT_AVAILABLE:return(0,Y.jsx)(a.cC,{id:"Due to health factor impact, a flashloan is required to perform this transaction, but Aave Governance has disabled flashloan availability for this asset. Try lowering the amount or supplying additional collateral."});default:return null}},Fe=(0,j.LN)(he,ae,K.decimals||18);(0,j.IG)(ge,ae,t.decimals);return _.success?(0,Y.jsx)(D.R,{action:(0,Y.jsx)(a.cC,{id:"Repaid"}),amount:ge,symbol:t.symbol}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(R.W,{value:Ie,onChange:Oe,usdValue:Ue,symbol:t.symbol,assets:[{address:t.underlyingAsset,symbol:t.symbol,iconSymbol:t.iconSymbol,balance:le}],isMaxSelected:ce,maxValue:le,inputTitle:(0,Y.jsx)(a.cC,{id:"Expected amount to repay"}),balanceText:(0,Y.jsx)(a.cC,{id:"Borrow balance"})}),(0,Y.jsxs)(b.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,Y.jsx)(f.Z,{sx:{fontSize:"18px !important"},children:(0,Y.jsx)(y.Z,{})}),(0,Y.jsx)(g.B,{loading:Te,outputAmountUSD:Ae,inputAmountUSD:xe})]}),(0,Y.jsx)(R.W,{value:he,usdValue:xe,symbol:K.symbol,assets:q,onSelect:X,onChange:Oe,inputTitle:(0,Y.jsx)(a.cC,{id:"Collateral to repay with"}),balanceText:(0,Y.jsx)(a.cC,{id:"Borrow balance"}),maxValue:J,loading:Te,disableInput:!0}),je&&!Te&&(0,Y.jsx)(v.Z,{variant:"helperText",color:"error.main",children:je}),void 0!==Ze&&(0,Y.jsx)(v.Z,{variant:"helperText",color:"error.main",children:(0,Y.jsx)(_e,{})}),(0,Y.jsxs)(L.m6,{gasLimit:W,slippageSelector:(0,Y.jsx)(E.n,{selectedSlippage:ae,setSlippage:oe,slippageTooltipHeader:(0,Y.jsx)(x.Z,{direction:"row",alignItems:"center",children:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(a.cC,{id:"Maximum collateral amount to use"}),(0,Y.jsx)(x.Z,{alignItems:"end",children:(0,Y.jsxs)(x.Z,{direction:"row",children:[(0,Y.jsx)(S.T1,{symbol:K.iconSymbol||"",sx:{mr:1,fontSize:"14px"}}),(0,Y.jsx)(A.B,{value:Fe,variant:"secondary12"})]})})]})})}),children:[(0,Y.jsx)(L.jz,{visibleHfChange:!!te,healthFactor:null===d||void 0===d?void 0:d.healthFactor,futureHealthFactor:Ee.toString(10),loading:Te}),(0,Y.jsx)(L.XJ,{description:(0,Y.jsx)(a.cC,{id:"Borrow balance after repay"}),futureValue:De.toString(),futureValueUSD:Le.toString(),symbol:r,tokenIcon:t.iconSymbol,loading:Te,hideSymbolSuffix:!0}),(0,Y.jsx)(L.XJ,{description:(0,Y.jsx)(a.cC,{id:"Collateral balance after repay"}),futureValue:Be.toString(),futureValueUSD:Ne.toString(),symbol:K.symbol,tokenIcon:K.iconSymbol,loading:Te,hideSymbolSuffix:!0})]}),Z&&(0,Y.jsx)(N.f,{txError:Z}),(0,Y.jsx)(Q,{poolReserve:t,fromAssetData:ie,repayAmount:ge,repayWithAmount:Fe,repayAllDebt:fe,useFlashLoan:Re,isWrongNetwork:c,symbol:r,rateMode:n,blocked:void 0!==Ze||""!==je,loading:Se,buildTxFn:we})]})}var X=r(84707),J=r(82403),$=r(20854),ee=r(69125),te=r(67916),re=r(85945),ne=r(56371),ae=r(28744),oe=r(93591),se=r(32113),ie=r(39771),le=r(31001),ue=["amountToRepay","poolReserve","poolAddress","isWrongNetwork","sx","symbol","repayWithATokens","blocked","maxApproveNeeded"];function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var pe,me=function(e){var t=e.amountToRepay,r=e.poolReserve,n=e.poolAddress,s=e.isWrongNetwork,i=e.sx,u=e.symbol,c=e.repayWithATokens,d=e.blocked,p=e.maxApproveNeeded,m=(0,U.Z)(e,ue),y=(0,F.Y)((function(e){return[e.repay,e.repayWithPermit,e.encodeRepayParams,e.encodeRepayWithPermitParams,e.tryPermit,e.walletApprovalMethodPreference,e.estimateGasLimit,e.addTransaction,e.useOptimizedPath,e.currentMarketData]})),b=(0,I.Z)(y,10),f=b[0],v=b[1],x=b[2],h=b[3],g=b[4],A=b[5],S=b[6],j=b[7],T=b[8],C=b[9],E=(0,k.Z)().sendTx,P=(0,re.NL)(),R=(0,o.useState)(),D=R[0],L=R[1],N=(0,l.vR)(),_=N.approvalTxState,H=N.mainTxState,V=N.loadingTxns,q=N.setMainTxState,Q=N.setTxError,G=N.setGasLimit,z=N.setLoadingTxns,K=N.setApprovalTxState,X=(0,oe.y)(C,n),J=X.data,$=X.refetch,ee=X.isFetching,te=X.isFetchedAfterMount,ce=g({reserveAddress:n,isWrappedBaseAsset:r.isWrappedBaseAsset}),pe=ce&&A===se.n.PERMIT;z(ee);var me=!c&&0!==Number(t)&&(0,B.iv)({approvedAmount:(null===J||void 0===J?void 0:J.amount)||"0",amount:-1===Number(t)?p:t,signedAmount:D?D.amount:"0"});me&&null!==_&&void 0!==_&&_.success&&K({});var ye=(0,ae.M)({usePermit:pe,approvedAmount:J,requiresApproval:me,assetAddress:n,symbol:u,decimals:r.decimals,signatureAmount:t,onApprovalTxConfirmed:$,onSignTxCompleted:function(e){return L(e)}}).approval;(0,o.useEffect)((function(){te||c||$()}),[$,te,c]);var be=function(){var e=(0,w.Z)(O().mark((function e(){var a,o,s,i,l,d,p,m,y;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,q(de(de({},H),{},{loading:!0})),o=W.UQ.default,!pe||!D){e.next=21;break}if(s={amount:"-1"===t?t:(0,ne.parseUnits)(t,r.decimals).toString(),reserve:n,interestRateMode:W.tk.Variable,signature:D.signature,deadline:D.deadline},!T()){e.next=9;break}return e.next=8,h(s);case 8:i=e.sent;case 9:return o=W.UQ.repayWithPermit,l=v(de(de({},s),{},{encodedTxData:i?i[0]:void 0})),e.next=13,S(l);case 13:return l=e.sent,e.next=16,E(l);case 16:return a=e.sent,e.next=19,a.wait(1);case 19:e.next=36;break;case 21:if(d={amountToRepay:"-1"===t?t:(0,ne.parseUnits)(t,r.decimals).toString(),poolAddress:n,repayWithATokens:c,debtType:W.tk.Variable},!T()){e.next=26;break}return e.next=25,x(d);case 25:p=e.sent;case 26:return o=W.UQ.repay,m=f(de(de({},d),{},{encodedTxData:p})),e.next=30,S(m);case 30:return m=e.sent,e.next=33,E(m);case 33:return a=e.sent,e.next=36,a.wait(1);case 36:q({txHash:a.hash,loading:!1,success:!0}),j(a.hash,{action:o,txState:"success",asset:n,amount:t,assetName:u}),P.invalidateQueries({queryKey:le.B.pool}),P.invalidateQueries({queryKey:le.B.gho}),e.next=47;break;case 42:e.prev=42,e.t0=e.catch(0),y=(0,ie.WG)(e.t0,ie.aD.GAS_ESTIMATION,!1),Q(y),q({txHash:void 0,loading:!1});case 47:case"end":return e.stop()}}),e,null,[[0,42]])})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){var e=0;pe?e=Number(Z.eB[W.UQ.supplyWithPermit].recommended):(e=Number(Z.eB[W.UQ.supply].recommended),me&&!_.success&&(e+=Number(B.pQ))),G(e.toString())}),[me,_,pe,G]),(0,Y.jsx)(M.B,de(de({blocked:d,preparingTransactions:V||!J,symbol:r.symbol,mainTxState:H,approvalTxState:_,requiresAmount:!0,amount:t,requiresApproval:me,isWrongNetwork:s,sx:i},m),{},{handleAction:be,handleApproval:ye,actionText:(0,Y.jsx)(a.cC,{id:"Repay {symbol}",values:{symbol:u}}),actionInProgressText:(0,Y.jsx)(a.cC,{id:"Repaying {symbol}",values:{symbol:u}}),tryPermit:ce}))},ye=function(e){var t,r,n,s=e.poolReserve,d=e.userReserve,p=e.symbol,y=e.tokenBalance,b=e.nativeBalance,f=e.isWrongNetwork,x=e.user,g=(0,l.vR)(),A=g.gasLimit,S=g.mainTxState,j=g.txError,w=(0,i.HT)().marketReferencePriceInUsd,T=(0,u.f)(),O=T.currentChainId,C=T.currentMarketData,k=T.currentMarket,E=(0,F.Y)((function(e){return[e.poolComputed.minRemainingBaseTokenBalance]})),P=(0,I.Z)(E,1)[0],B=(0,o.useState)({address:s.underlyingAsset,symbol:s.symbol,iconSymbol:s.iconSymbol,balance:y}),N=B[0],U=B[1],W=(0,o.useState)([N]),_=W[0],M=W[1],H=(0,o.useState)(""),V=H[0],q=H[1],Q=(0,o.useState)(""),G=Q[0],z=Q[1],K=(0,o.useRef)(),re=(0,c.Mo)(O),ne=d.underlyingBalance,ae=d.usageAsCollateralEnabledOnUser,oe=d.reserve,se=N.address===s.aTokenAddress,ie=(null===d||void 0===d?void 0:d.variableBorrows)||"0",le=new h.Z(ie).multipliedBy(s.formattedPriceInMarketReferenceCurrency).multipliedBy(w).shiftedBy(-J.$3),ue=(0,m.hE)(ie).multipliedBy("1.0025").decimalPlaces(s.decimals,h.Z.ROUND_UP);if(se)r=h.Z.min(ne,ie),n=ne;else{var ce=(0,m.hE)(N.balance).minus((null===d||void 0===d?void 0:d.reserve.symbol.toUpperCase())===re.baseAssetSymbol?P:"0");n=ce.toString(10),r=h.Z.min(ce,ie)}var de="-1"===G,pe=de?r.toString(10):G;(0,o.useEffect)((function(){var e=[];if(s.symbol===re.wrappedBaseAssetSymbol){var t=(0,m.hE)(b),r=h.Z.max(t,h.Z.min(t,ie));e.push({address:Z.hP.toLowerCase(),symbol:re.baseAssetSymbol,balance:r.toString(10)})}var n=h.Z.min((0,m.hE)(y),ie),a=h.Z.max(n,y);if(e.push({address:s.underlyingAsset,symbol:s.symbol,iconSymbol:s.iconSymbol,balance:a.toString(10)}),C.v3&&!(0,ee.F$)({symbol:s.symbol,currentMarket:k})){var o=(0,m.hE)(ne),i=h.Z.max(o,h.Z.min(o,ie).toString(10));e.push({address:s.aTokenAddress,symbol:"a".concat(s.symbol),iconSymbol:s.iconSymbol,aToken:!0,balance:i.toString(10)})}M(e),U(e[0])}),[]);var ye=(0,m.hE)(ie).minus(pe||"0").toString(10),be=new h.Z(ye).multipliedBy(s.formattedPriceInMarketReferenceCurrency).multipliedBy(w).shiftedBy(-J.$3),fe=de&&be.toNumber()>0,ve=null===x||void 0===x?void 0:x.healthFactor;if(pe){var xe=(null===x||void 0===x?void 0:x.totalCollateralUSD)||"0";se&&ae&&(xe=(0,m.hE)((null===x||void 0===x?void 0:x.totalCollateralUSD)||"0").minus((0,m.hE)(oe.priceInUSD).multipliedBy(pe)));var he=(0,m.hE)((null===x||void 0===x?void 0:x.totalBorrowsUSD)||"0").minus((0,m.hE)(oe.priceInUSD).multipliedBy(pe)),ge=h.Z.max(he,0),Ae=(0,$.L1)({collateralBalanceMarketReferenceCurrency:xe,borrowBalanceMarketReferenceCurrency:ge,currentLiquidationThreshold:(null===x||void 0===x?void 0:x.currentLiquidationThreshold)||"0"});ve=Ae.isLessThan(0)&&!Ae.eq(-1)?"0":Ae.toString(10)}var Se=(0,m.hE)(pe).multipliedBy(oe.priceInUSD);return S.success?(0,Y.jsx)(D.R,{action:(0,Y.jsx)(a.cC,{id:"repaid"}),amount:K.current,symbol:se?s.symbol:N.symbol}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(R.W,{value:pe,onChange:function(e){var t="-1"===e;K.current=t?r.toString(10):e,z(e),t&&(se||r.eq(ie))?N.address===Z.hP.toLowerCase()||X.U[O]&&X.U[O].toLowerCase()===oe.underlyingAsset.toLowerCase()?q(ue.toString(10)):q("-1"):q(ue.lt(n)?ue.toString(10):r.toString(10))},usdValue:Se.toString(10),symbol:N.symbol,assets:_,onSelect:U,isMaxSelected:de,maxValue:r.toString(10),balanceText:(0,Y.jsx)(a.cC,{id:"Wallet balance"})}),fe&&(0,Y.jsx)(v.Z,{color:"warning.main",variant:"helperText",children:(0,Y.jsx)(a.cC,{id:"You don\u2019t have enough funds in your wallet to repay the full amount. If you proceed to repay with your current amount of funds, you will still have a small borrowing position in your dashboard."})}),(0,Y.jsxs)(L.m6,{gasLimit:A,children:[(0,Y.jsx)(L.XJ,{description:(0,Y.jsx)(a.cC,{id:"Remaining debt"}),futureValue:ye,futureValueUSD:be.toString(10),value:ie,valueUSD:le.toString(),symbol:s.iconSymbol===re.wrappedBaseAssetSymbol?re.baseAssetSymbol:s.iconSymbol}),(0,Y.jsx)(L.jz,{visibleHfChange:!!G,healthFactor:null===x||void 0===x?void 0:x.healthFactor,futureHealthFactor:ve})]}),j&&(0,Y.jsx)(te.Q,{txError:j}),(0,Y.jsx)(me,{maxApproveNeeded:ue.toString(),poolReserve:s,amountToRepay:de?V:pe,poolAddress:se?s.underlyingAsset:null!==(t=N.address)&&void 0!==t?t:"",isWrongNetwork:f,symbol:p,repayWithATokens:se})]})},be=r(34637),fe=r(59379),ve=r(57609);function xe(e){var t,r=e.repayType,n=e.setRepayType,o=(0,u.f)().currentMarketData,s=(0,F.Y)((function(e){return e.trackEvent}));return null!==(t=o.enabledFeatures)&&void 0!==t&&t.collateralRepay?(0,Y.jsxs)(b.Z,{sx:{mb:6},children:[(0,Y.jsx)(v.Z,{mb:1,color:"text.secondary",children:(0,Y.jsx)(a.cC,{id:"Repay with"})}),(0,Y.jsxs)(fe.f,{color:"primary",value:r,exclusive:!0,onChange:function(e,t){return n(t)},children:[(0,Y.jsx)(be.Y,{value:pe.BALANCE,disabled:r===pe.BALANCE,onClick:function(){return s(ve.rQ.SWITCH_REPAY_TYPE,{repayType:"Wallet Balance"})},children:(0,Y.jsx)(v.Z,{variant:"buttonM",children:(0,Y.jsx)(a.cC,{id:"Wallet balance"})})}),(0,Y.jsx)(be.Y,{value:pe.COLLATERAL,disabled:r===pe.COLLATERAL,onClick:function(){return s(ve.rQ.SWITCH_REPAY_TYPE,{repayType:"Collateral"})},children:(0,Y.jsx)(v.Z,{variant:"buttonM",children:(0,Y.jsx)(a.cC,{id:"Collateral"})})})]})]}):null}function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.BALANCE=0]="BALANCE",e[e.COLLATERAL=1]="COLLATERAL"}(pe||(pe={}));var Ae=function(){var e=(0,l.vR)(),t=e.type,r=e.close,n=e.args,m=e.mainTxState,y=(0,i.HT)().userReserves,b=(0,u.f)().currentMarketData,f=(0,o.useState)(pe.BALANCE),v=f[0],x=f[1],h=c.cr.collateralRepay(b)&&y.some((function(e){return"0"!==e.scaledATokenBalance&&e.underlyingAsset!==n.underlyingAsset}));return(0,Y.jsx)(d.P,{open:t===l.w8.Repay,setOpen:function(){x(pe.BALANCE),r()},children:(0,Y.jsx)(p.A,{title:(0,Y.jsx)(a.cC,{id:"Repay"}),underlyingAsset:n.underlyingAsset,children:function(e){return(0,Y.jsx)(s.X,{children:function(t){return(0,Y.jsxs)(Y.Fragment,{children:[h&&!m.txHash&&(0,Y.jsx)(xe,{repayType:v,setRepayType:x}),v===pe.BALANCE&&(0,Y.jsx)(ye,ge(ge({},e),{},{user:t})),v===pe.COLLATERAL&&(0,Y.jsx)(K,ge(ge({},e),{},{debtType:n.currentRateMode,user:t}))]})}})}})})}},52358:function(e,t,r){var n=r(67294);const a=n.forwardRef((function(e,t){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 14l-7 7m0 0l-7-7m7 7V3"}))}));t.Z=a}}]);